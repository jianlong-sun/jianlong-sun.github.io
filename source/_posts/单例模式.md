---
title: 单例模式
categories: java
description: 单例模式的几种实现方式，推荐使用volatile + double check 方式
date: 2019-08-29 11:12:26
tags: 单例模式
---
> 引用参考自：汪文君 Java高并发编程详解

 **推荐使用volatile + double check 方式**
# 1.饿汉式单例模式
## 1.1先上代码
```java
    public class SingletonObject1 {
    
        /**
         * can't lazy load.
         */
        private static final SingletonObject1 instance = new SingletonObject1();
    
        private SingletonObject1() {
            //empty
        }
    
        public static SingletonObject1 getInstance() {
            return instance;
        }
    }
```
## 1.2优缺点
```
    饿汉式单例模式可以保证多个线程下的唯一实例，getInstance方法性能也比较高，但是无法进行懒加载
```
# 2.懒汉式+同步
## 2.1代码如下
```java
    public class SingletonObject3 {
        private static SingletonObject3 instance;
    
        private SingletonObject3() {
            //empty
        }
    
        public synchronized static SingletonObject3 getInstance() {
    
            if (null == instance)
                instance = new SingletonObject3();
    
            return SingletonObject3.instance;
        }
    }
```
## 2.2优缺点 
```
    synchronized 关键字天生排他性导致getInstance方法只能在同一时刻被一个线程访问，性能低下。
```
<!--more-->
# 3.volatile + double check 方式
## 3.1代码如下
```java
public class SingletonObject5 {

    private static volatile SingletonObject5 instance;

    private SingletonObject5() {
        //
    }

    //double check add volatile
    public static SingletonObject5 getInstance() {

        if (null == instance) {
            synchronized (SingletonObject5.class) {
                if (null == instance)
                    instance = new SingletonObject5();
            }
        }
        return SingletonObject5.instance;
    }
}

```
## 3.2优缺点
```
    不加volatile,会报空指针的问题，，加上volatile关键词会防止重排序的发生，是一种巧妙的程序设计
```
# 4.holder方式及枚举方式待续。。。。